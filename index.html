<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAISO DSR - Enquiry Log</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { background-color: #0a0a0a; font-family: 'Inter', sans-serif; color: #ffffff; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; padding: 20px; }
        .gold-text { color: #c5a059; }
        .gold-border { border: 1px solid #c5a059; }
        .card { background-color: #141414; border-radius: 12px; border: 1px solid #222; width: 100%; max-width: 450px; padding: 35px; }
        input, textarea { background-color: #1e1e1e !important; border: 1px solid #333 !important; color: #fff !important; width: 100%; padding: 12px; border-radius: 8px; outline: none; margin-bottom: 20px; }
        input:focus { border-color: #c5a059 !important; }
        .btn { border: 1px solid #c5a059; color: #c5a059; width: 100%; padding: 15px; border-radius: 8px; font-weight: bold; letter-spacing: 2px; transition: 0.3s; cursor: pointer; }
        .btn:hover { background-color: #c5a059; color: #000; }
        .label { font-size: 10px; font-weight: bold; color: #c5a059; text-transform: uppercase; margin-bottom: 5px; display: block; letter-spacing: 1px; }
    </style>
</head>
<body>

    <div class="card shadow-2xl">
        <div class="text-center mb-10">
            <h1 style="font-family: 'Orbitron';" class="text-2xl gold-text tracking-widest">TAISO DSR</h1>
            <p class="text-gray-500 text-[10px] tracking-[0.2em] mt-2 uppercase">Data Synchronization Portal</p>
        </div>

        <form id="enquiryForm">
            <label class="label">Customer Name</label>
            <input type="text" name="Name" placeholder="Full Name" required>

            <label class="label">Phone Number</label>
            <input type="tel" name="Phone" placeholder="91XXXXXXXX" required>

            <label class="label">Next Follow-up Date</label>
            <input type="date" name="NextUpdate" required>

            <label class="label">Discussion Details</label>
            <textarea name="Discussion" rows="4" placeholder="Summary of call..." required></textarea>

            <button type="submit" id="submitBtn" class="btn uppercase">Save Entry</button>
        </form>

        <div id="status" class="mt-5 text-center hidden">
            <p id="statusMsg" class="text-xs font-bold"></p>
        </div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyYxGiKOamogxbn4kqcOySjxA2WD7ov5ubmg2iXpFQ4X4ZeXBSnLJvrCl4TaBV0Deq3/exec';
        const form = document.getElementById('enquiryForm');
        const btn = document.getElementById('submitBtn');
        const statusDiv = document.getElementById('status');
        const statusMsg = document.getElementById('statusMsg');

        form.addEventListener('submit', e => {
            e.preventDefault();
            btn.disabled = true;
            btn.innerHTML = "SENDING...";
            statusDiv.classList.remove('hidden');
            statusMsg.style.color = "#c5a059";
            statusMsg.innerHTML = "Attempting to write to Google Sheet...";

            fetch(scriptURL, { method: 'POST', body: new FormData(form)})
            .then(response => response.json())
            .then(data => {
                console.log('Success!', data);
                if(data.result === 'success') {
                    statusMsg.style.color = "#22c55e";
                    statusMsg.innerHTML = "âœ” SUCCESS! DATA ADDED TO SHEET";
                    form.reset();
                } else {
                    statusMsg.style.color = "#ef4444";
                    statusMsg.innerHTML = "ERROR: " + (data.error || "Check Script Version");
                }
                btn.disabled = false;
                btn.innerHTML = "SAVE ENTRY";
            })
            .catch(error => {
                console.error('Error!', error.message);
                statusMsg.style.color = "#ef4444";
                statusMsg.innerHTML = "FAILED: Check Script Deployment Settings";
                btn.disabled = false;
                btn.innerHTML = "SAVE ENTRY";
            });
        });
    </script>
</body>
</html>
